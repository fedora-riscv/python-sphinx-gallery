From fa2ea5f35051846e43837c6eb87496435a6064c0 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Lo=C3=AFc=20Est=C3=A8ve?= <loic.esteve@ymail.com>
Date: Mon, 21 Nov 2016 11:18:58 +0100
Subject: [PATCH] Read file as bytes to compute its hash

Fix #170
---
 sphinx_gallery/gen_rst.py | 8 ++------
 1 file changed, 2 insertions(+), 6 deletions(-)

diff --git a/sphinx_gallery/gen_rst.py b/sphinx_gallery/gen_rst.py
index 60da46b..e21d5fc 100644
--- a/sphinx_gallery/gen_rst.py
+++ b/sphinx_gallery/gen_rst.py
@@ -288,19 +288,15 @@ def extract_intro(filename):
 def get_md5sum(src_file):
     """Returns md5sum of file"""
 
-    with open(src_file, 'r') as src_data:
+    with open(src_file, 'rb') as src_data:
         src_content = src_data.read()
 
-        # data needs to be encoded in python3 before hashing
-        if sys.version_info[0] == 3:
-            src_content = src_content.encode('utf-8')
-
         src_md5 = hashlib.md5(src_content).hexdigest()
     return src_md5
 
 
 def md5sum_is_current(src_file):
-    """Returns True if src_file has the same md5 hash as the one stored on disk"""
+    """Checks whether src_file has the same md5 hash as the one on disk"""
 
     src_md5 = get_md5sum(src_file)
 
